
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Windows event log (evt) - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#header-record" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Windows event log (evt)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../community/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../contributions_mediawiki/" class="md-tabs__link">
        Contributions
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../tags/" class="md-tabs__link">
        Tags
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Contributions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributions" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contributions_mediawiki/" class="md-nav__link">
        Contributions Mediawiki
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tags
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tags" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tags
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        Tags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#header-record" class="md-nav__link">
    Header Record
  </a>
  
    <nav class="md-nav" aria-label="Header Record">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flags" class="md-nav__link">
    Flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cursor-record" class="md-nav__link">
    Cursor Record
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-record" class="md-nav__link">
    Event Record
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#padding" class="md-nav__link">
    Padding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#message-templates" class="md-nav__link">
    Message Templates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-links" class="md-nav__link">
    External Links
  </a>
  
    <nav class="md-nav" aria-label="External Links">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-format" class="md-nav__link">
    File Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-identifiers" class="md-nav__link">
    Event identifiers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-2000" class="md-nav__link">
    Windows 2000
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  

  <nav class="md-tags" >
    
      
      
        <a href="../tags/#file-formats" class="md-tag">File Formats</a>
      
    
      
      
        <a href="../tags/#windows" class="md-tag">Windows</a>
      
    
      
      
        <a href="../tags/#binary" class="md-tag">Binary</a>
      
    
  </nav>




  <h1>Windows event log (evt)</h1>

<p>MS Windows 2000, XP and 2003 typically maintain three Event Log files:
Application, System, and Security. They are generally found in the
C:\Windows\system32\config directory. Server versions of the OS may
maintain additional Event Logs (DNS Server.evt, Directory Service.evt,
File Replication Service.evt) depending upon the functionality of the
server.</p>
<p>Note that Windows Vista and later use the <a href="../windows_xml_event_log_%28evtx%29/">Windows XML Event Log
(evtx)</a> format.</p>
<p>Each log file consists of a Header record and the Body. The body again
consists of Event records, the Cursor record and unused space. The body
could form a ring buffer, where the cursor record will mark the border
between the oldest and the newest event record. Unused space could be
empty, slack and padding.</p>
<h2 id="header-record">Header Record</h2>
<p>The Header Record defined as
<a href="http://msdn.microsoft.com/en-us/library/bb309024%28VS.85%29.aspx">ELF_LOGFILE_HEADER</a>
on MSDN consists of:</p>
<ol>
<li>uint32 length of record in bytes, fixed 0x30</li>
<li>char magic[4], fixed 'LfLe' (for Event log file)</li>
<li>uint32 unknown, fixed 0x0100 0x0000, possibly indicates version</li>
<li>uint32 unknown, fixed 0x0100 0x0000, possibly indicates version</li>
<li>uint32 offset of first event record</li>
<li>uint32 offset of next event record</li>
<li>uint32 number of next event record</li>
<li>uint32 number of first event record</li>
<li>uint32 filesize (see below)</li>
<li>uint32 flags (see below)</li>
<li>uint32 retention period in seconds</li>
<li>uint32 length of record in bytes (again), fixed 0x30</li>
</ol>
<p>Offsets and record numbers are updated only during a file close
operation, that is if the DIRTY flag (see below) is unset. Consult the
cursor record in that case.</p>
<p>Filesize is updated only during some recovery operations.</p>
<h3 id="flags">Flags</h3>
<ul>
<li>0x0001 DIRTY if set, flag is set after first first write after an open
  operation.</li>
<li>0x0002 WRAPPED is set, flag is set if the log wrapped around.</li>
<li>0x0004 FULL if set, flag is set if an event record could not be
  written because of size limitations and the retention policy in
  effect.</li>
<li>0x0008 PRIMARY if set, BACKUP if unset. This flag possibly depends on
  the origin of a log file, usage seems change between earlier (pre SP1)
  and later versions (SP4) of Windows 2000.</li>
</ul>
<h2 id="cursor-record">Cursor Record</h2>
<ol>
<li>uint32 length of record in bytes, fixed 0x28</li>
<li>uint32 magic[4], fixed 0x11111111 0x22222222 0x33333333 0x44444444</li>
<li>uint32 offset of first event record</li>
<li>uint32 offset of next event record</li>
<li>uint32 number of next event record</li>
<li>uint32 number of first event record</li>
<li>uint32 length of record in bytes, fixed 0x28</li>
</ol>
<h2 id="event-record">Event Record</h2>
<p>Details of the Event record can be found in Microsoft's MSDN library
under
<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/eventlog/base/eventlogrecord_str.asp">EVENTLOGRECORD</a>.</p>
<h2 id="padding">Padding</h2>
<p>If</p>
<ul>
<li>a log file has reached its configured size limit</li>
<li>and the retention policy allows wrapping</li>
<li>and the remaining size is larger than 0x38 but smaller than the event
  record to be written,</li>
</ul>
<p>then</p>
<ul>
<li>the event log service writes the first part of the event record (to
  record offset 0x38)</li>
<li>fills the remaining space with a padding of 0x0027</li>
<li>continues to write the second part of the event record (starting at
  record offset 0x38) at the top of the body (immediately after the
  header, that is at file offset 0x30).</li>
</ul>
<h2 id="message-templates">Message Templates</h2>
<p>When written to disk, EVT log records contain very little human-readable
context. Log entries are made human-readable at analysis time through
tools such as the event viewer, by combining pre-defined log templates
(stored in system DLLs and EXEs) with variable data stored in the EVT
file. The templates and variable data are combined with a call to
FormatMessage(), which means the templates look similar to printf()'s
format strings.</p>
<p>When event viewer (or other log viewing tools) displays log records, it
has to determine which DLLs store the message templates. This linking
information is stored in the registry, and is specific to each type of
log (System, Security, Application, etc). These entries ultimately point
out a list of DLLs which contain the message templates. Each log record
contains a relative virtual address (RVA) to reference the associated
message template. The lower 16 bits of this RVA is typically displayed
as the Message ID, but this alone generally isn't enough to uniquely
reference a message template.</p>
<p>All of this means that EVT files aren't really complete on their own.
The files which store the core meaning of the log entry are separate
from the logs themselves and this creates several analysis problems.
First of all, an attacker could modify DLLs or the registry in order to
change the meaning of logs without having to touch the EVT file at all.
Secondly, when software is uninstalled in the future, it could cause
some EVT records to lose their context. Finally, EVT files aren't
particularly portable to other systems, since some log records could
rely on message templates which don't exist on other systems. One must
be careful to keep these issues in mind when analyzing EVT logs.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../windows_xml_event_log_%28evtx%29/">Windows XML Event Log
  (evtx)</a></li>
<li><a href="../windows/">Windows</a></li>
</ul>
<h2 id="external-links">External Links</h2>
<h3 id="file-format">File Format</h3>
<ul>
<li><a href="http://code.google.com/p/libevt/downloads/detail?name=Windows%20Event%20Log%20%28EVT%29.pdf">Windows Event Log (EVT)
  format</a>,
  by the <a href="../libevt/">libevt project</a></li>
</ul>
<h3 id="event-identifiers">Event identifiers</h3>
<ul>
<li><a href="http://eventid.net/">EventID.net</a></li>
</ul>
<h3 id="windows-2000">Windows 2000</h3>
<ul>
<li><a href="http://www.eventreporter.com/common/en/securityreference/win-eventcorrelation-processtracking.php">Correlation of Windows Process Tracking
  Events</a></li>
</ul>
<h2 id="tools">Tools</h2>
<ul>
<li><a href="http://projects.sentinelchicken.org/grokevt">GrokEVT</a> is a set of
  forensics scripts designed to make sense of EVT logs for
  investigations. Along with RegLookup, it is able to combine registry
  information and event log templates to place EVT data in context.
  (UN*X platforms only.)</li>
<li><a href="http://www.cpan.org/modules/by-authors/id/H/HC/HCARVEY/"><File::ReadEVT></a>
  is a Perl module that parses event log files for the purpose of
  forensics.</li>
<li><a href="http://www.tzworks.net/prototype_page.php?proto_id=4">Windows Eventlog
  Viewer</a> Free
  tool that can be run on Windows, Linux or Mac OS-X. Parses Windows XP,
  Vista and Windows 7 eventlogs.</li>
<li><a href="http://www.tzworks.net/prototype_page.php?proto_id=25">evtwalk</a>
  Command line tool to pull events and generate reports (password
  changes, logons, clock changes, system start/stop, and credential
  changes) from Windows event logs.</li>
<li><a href="../libevt/">libevt</a></li>
<li><a href="https://github.com/williballenthin/LfLe">lfle.py</a>, by <a href="willi_ballenthin.md">Willi
  Ballenthin</a></li>
<li><a href="https://github.com/yarox24/evtkit">evtkit - fix broken evt files</a></li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>