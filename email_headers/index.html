
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Email headers - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#making-sense-of-headers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Email headers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../community/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../contributions_mediawiki/" class="md-tabs__link">
        Contributions
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../tags/" class="md-tabs__link">
        Tags
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Contributions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributions" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contributions_mediawiki/" class="md-nav__link">
        Contributions Mediawiki
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tags
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tags" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tags
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        Tags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#making-sense-of-headers" class="md-nav__link">
    Making Sense of Headers
  </a>
  
    <nav class="md-nav" aria-label="Making Sense of Headers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#senders-ip-address" class="md-nav__link">
    Sender's IP Address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mail-user-agents" class="md-nav__link">
    Mail User Agents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#servers-in-transit" class="md-nav__link">
    Servers in Transit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#message-id-field" class="md-nav__link">
    Message Id Field
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signature-fields" class="md-nav__link">
    Signature Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-header" class="md-nav__link">
    Sample Header
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-links" class="md-nav__link">
    External Links
  </a>
  
    <nav class="md-nav" aria-label="External Links">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  

  <nav class="md-tags" >
    
      
      
        <a href="../tags/#email-analysis" class="md-tag">Email Analysis</a>
      
    
  </nav>




  <h1>Email headers</h1>

<p><strong>Email Headers</strong> are lines of <a href="../metadata/">metadata</a> attached
to each <a href="email.md">email</a> that contain lots of useful
information for a <a href="forensic_investigator.md">forensic
investigator</a>. However, email headers
can be easily forged, so they should never be used as the only source of
information.</p>
<h2 id="making-sense-of-headers">Making Sense of Headers</h2>
<p>There is no single way to make sense of email headers. Some examiners
favor reading from the bottom up, some favor reading from the top down.
Because information in the headers can be put there by the user's
<a href="mail_user_agent.md">MUA</a>, a server in transit, or the
recipient's <a href="mail_user_agent.md">MUA</a>, it can be difficult to
determine when a line was added.</p>
<h3 id="senders-ip-address">Sender's IP Address</h3>
<p>Some web-based email providers include the sender's IP address in the
message headers. Some do not.</p>
<h3 id="mail-user-agents">Mail User Agents</h3>
<p>Every <a href="mail_user_agent.md">MUA</a> sets up the headers for a
message slightly differently. Although some headers are required under
the applicable <a href="http://www.faqs.org/rfcs/rfc2822.html">RFC</a>, their
format and ordering can vary by client. Almost all clients, however, add
their headers in a fixed format and order. The examiner can use the
format and order for each client to show that messages were forged, but
not that they were legitimate. For example, if a message purports to be
from <a href="../apple_mail/">Apple Mail</a> but the order or the headers do
not match the <a href="../apple_mail_header_format/">Apple Mail Header
Format</a>, the message has been
forged. If the headers of the message do match that format, however, it
does not guarantee that the message was sent by that program.</p>
<h3 id="servers-in-transit">Servers in Transit</h3>
<p>Mail servers can add lines onto email headers, usually in the form of
"Received" lines, like this:</p>
<pre><code>Received: by servername.recipeienthost.com (Postfix, from userid 506)
    id 77C30808A; Sat, 24 Feb 2007 20:43:56 -0500 (EST)
</code></pre>
<h2 id="message-id-field">Message Id Field</h2>
<p>. According to the current guidelines for email
<a href="http://www.faqs.org/rfcs/rfc2822.html">1</a>, every message should have a
Message-ID field. These id fields can be used to determine if a message
has been forged. It is harder, but sometimes possible, to show that a
message is authentic using the message id field. Where known, the
Message-ID algorithms for known programs are <a href="../list_of_mua_header_formats/">given on the separate
pages for those programs</a>.</p>
<h2 id="signature-fields">Signature Fields</h2>
<p>. Some email programs allow users to sign messages. This gives the
recipient some assurance that the sender given in the message really
sent the message. Obviously these headers can be used by an examiner for
the same purpose.</p>
<h2 id="sample-header">Sample Header</h2>
<p>This is an (incomplete) excerpt from an email header:</p>
<p><code>Received: from lists.securityfocus.com (lists.securityfocus.com [205.206.231.19])</code>
<code>by outgoing2.securityfocus.com (Postfix) with QMQP</code>
<code>id 7E9971460C9; Mon,  9 Jan 2006 08:01:36 -0700 (MST)</code>
<code>Mailing-List: contact forensics-help@securityfocus.com; run by ezmlm</code>
<code>Precedence: bulk</code>
<code>List-Id: &lt;forensics.list-id.securityfocus.com&gt;</code>
<code>List-Post: &lt;</code><a href="mailto:forensics@securityfocus.com"><code>mailto:forensics@securityfocus.com</code></a><code>&gt;</code>
<code>List-Help: &lt;</code><a href="mailto:forensics-help@securityfocus.com"><code>mailto:forensics-help@securityfocus.com</code></a><code>&gt;</code>
<code>List-Unsubscribe: &lt;</code><a href="mailto:forensics-unsubscribe@securityfocus.com"><code>mailto:forensics-unsubscribe@securityfocus.com</code></a><code>&gt;</code>
<code>List-Subscribe: &lt;</code><a href="mailto:forensics-subscribe@securityfocus.com"><code>mailto:forensics-subscribe@securityfocus.com</code></a><code>&gt;</code>
<code>Delivered-To: mailing list forensics@securityfocus.com</code>
<code>Delivered-To: moderator for forensics@securityfocus.com</code>
<code>Received: (qmail 20564 invoked from network); 5 Jan 2006 16:11:57 -0000</code>
<code>From: YJesus &lt;yjesus@security-projects.com&gt;</code>
<code>To: forensics@securityfocus.com</code>
<code>Subject: New Tool : Unhide</code>
<code>User-Agent: KMail/1.9</code>
<code>MIME-Version: 1.0</code>
<code>Content-Disposition: inline</code>
<code>Date: Thu, 5 Jan 2006 16:41:30 +0100</code>
<code>Content-Type: text/plain;</code>
<code>charset="iso-8859-1"</code>
<code>Content-Transfer-Encoding: quoted-printable</code>
<code>Message-Id: &lt;200601051641.31830.yjesus@security-projects.com&gt;</code>
<code>X-HE-Spam-Level: /</code>
<code>X-HE-Spam-Score: 0.0</code>
<code>X-HE-Virus-Scanned: yes</code>
<code>Status: RO</code>
<code>Content-Length: 586</code>
<code>Lines: 26</code></p>
<h2 id="external-links">External Links</h2>
<ul>
<li><a href="http://en.wikipedia.org/wiki/E-mail#Header">Wikipedia entry on email
  headers</a></li>
</ul>
<h3 id="tools">Tools</h3>
<ul>
<li><a href="http://www.mailxaminer.com/product/">MailXaminer product page</a></li>
<li><a href="https://en.wikipedia.org/wiki/MailXaminer">Wikipedia: MailXaminer</a></li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>