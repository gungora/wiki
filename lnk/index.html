
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Lnk - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#file-format" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lnk
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../community/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../contributions_mediawiki/" class="md-tabs__link">
        Contributions
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../tags/" class="md-tabs__link">
        Tags
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Contributions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributions" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contributions_mediawiki/" class="md-nav__link">
        Contributions Mediawiki
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tags
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tags" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tags
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        Tags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-format" class="md-nav__link">
    File Format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata" class="md-nav__link">
    Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-links" class="md-nav__link">
    External Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commercial-tools" class="md-nav__link">
    Commercial tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#free-non-open-source" class="md-nav__link">
    Free (Non Open Source)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-source" class="md-nav__link">
    Open Source
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  

  <nav class="md-tags" >
    
      
      
        <a href="../tags/#file-formats" class="md-tag">File Formats</a>
      
    
      
      
        <a href="../tags/#windows" class="md-tag">Windows</a>
      
    
  </nav>




  <h1>Lnk</h1>

<p>Microsoft Windows Shortcut Files</p>
<h2 id="file-format">File Format</h2>
<p>The Windows Shortcut file has the extension .lnk. It basically is a
metadata file, specific for the Microsoft Windows platform and is
interpreted by the Windows Shell. The file format indicates that these
files contain a specific signature, 0x4C (4C 00 00 00) at offset 0
within the file/stream. Further, the GUID (CLSID)
00021401-0000-0000-c000-000000000046 stored at byte offset 4 makes a
good identifier.</p>
<p>Understanding this file format can be extremely useful for an analyst,
as not only are shortcut files employed from (at least) Windows 95
through Windows 10, but the binary format is also used in the numbered
streams within *.automaticDestinations-ms and *.customDestinations-ms
<a href="../jump_lists/">Jump Lists</a> files on <a href="../windows_7/">Windows
7</a> and later.</p>
<h2 id="metadata">Metadata</h2>
<ul>
<li><a href="../mac_times/">MAC times</a> of the target. These are a snapshot
  of the target date and timestamps before it was last opened. The
  target can be several things like for example a (linked) file;</li>
</ul>
<!-- -->

<pre><code>Linked file information:
    Creation time       : Jul 26, 2009 14:44:34 UTC
    Modification time   : Jul 26, 2009 14:44:34 UTC
    Access time     : Aug 12, 2010 06:41:50 UTC
    Local path      : C:\Program Files (x86)\Windows Live\Mail\wlmail.exe
</code></pre>
<ul>
<li>The <a href="../shell_item/">Shell Item</a> list of the target;</li>
<li>The size of the target when it was last accessed;</li>
<li>Serial number of the volume where the target was stored;</li>
<li>Useful for correlating a USB drive or other removable media (if you
    can get the volume serial number off it) to a particular user or
    system.</li>
<li>Network volume share name;</li>
<li>Read-only, hidden, system, volume label, encryption, sparse,
  compressed, offline and several other target attributes;</li>
<li>MAC address of the host computer (sometimes);</li>
<li>Distributed link tracking information, e.g.</li>
</ul>
<!-- -->

<pre><code>Distributed link tracker information:
    Machine identifier string           : mysystem
    Droid volume identifier             : 11111111-2222-3333-4444-555555555555
    Droid file identifier               : aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee
    Birth droid volume identifier       : 11111111-2222-3333-4444-555555555555
    Birth droid file identifier         : aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee
</code></pre>
<h2 id="notes">Notes</h2>
<p>Windows Shell commands:</p>
<pre><code>%windir%\explorer.exe ::{7007ACC7-3202-11D1-AAD2-00805FC1270E}

%windir%\explorer.exe shell:::{3080F90D-D7AD-11D9-BD98-0000947B0257}
</code></pre>
<p><a href="http://docs.rainmeter.net/tips/launching-windows-special-folders">http://docs.rainmeter.net/tips/launching-windows-special-folders</a></p>
<h2 id="external-links">External Links</h2>
<ul>
<li><a href="http://computerforensics.parsonage.co.uk/downloads/TheMeaningofLIFE.pdf">The Meaning of Linkfiles In Forensic
  Examinations</a>,
  by <a href="harry_parsonage.md">Harry Parsonage</a>, September 2008</li>
<li><a href="http://msdn.microsoft.com/en-us/library/dd871305%28PROT.13%29.aspx">MS-SHLLINK</a></li>
<li><a href="https://github.com/libyal/liblnk/blob/master/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc">Windows Shortcut File (LNK)
  format</a>,
  by the <a href="../liblnk/">liblnk project</a></li>
<li><a href="http://www.forensicfocus.com/link-file-evidentiary-value">Evidentiary Value of Link
  Files</a>, by
  Nathan Weilbacher</li>
<li><a href="http://blog.0x01000000.org/2010/08/10/lnk-parsing-youre-doing-it-wrong-i/">LNK Parsing: You’re doing it wrong
  (I)</a>,
  by <a href="jordi_sánchez_lópez.md">Jordi Sánchez López</a>, August 10,
  2010</li>
<li><a href="http://blog.0x01000000.org/2010/08/13/lnk-parsing-youre-doing-it-wrong-ii/">LNK Parsing: You’re doing it wrong
  (II)</a>,
  by <a href="jordi_sánchez_lópez.md">Jordi Sánchez López</a>, August 13,
  2010</li>
</ul>
<h2 id="tools">Tools</h2>
<h2 id="commercial-tools">Commercial tools</h2>
<ul>
<li><a href="http://www.tzworks.net/prototype_page.php?proto_id=11">Windows LNK Parsing Utility
  (lp)</a>, \$210.00
  tool that can be run on Windows, Linux or Mac OS-X</li>
</ul>
<h2 id="free-non-open-source">Free (Non Open Source)</h2>
<ul>
<li><a href="http://mitec.cz/wfa.html">Windows File Analyzer</a>, free tool that is
  capable of reading and reporting on Windows shortcut files</li>
</ul>
<h2 id="open-source">Open Source</h2>
<ul>
<li><a href="http://jafat.sourceforge.net/files.html">jafat</a>, free tool (in PERL)
  that is capable of reading and reporting on Windows shortcut files</li>
<li><a href="../liblnk/">liblnk</a></li>
<li><a href="http://code.google.com/p/lnk-parser/">lnk-parser</a></li>
<li><a href="https://github.com/EricZimmerman/Lnk/">lnk parser in C# that parses all
  structures</a></li>
<li><a href="https://github.com/EricZimmerman/LECmd/">LECmd command line tool</a></li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>