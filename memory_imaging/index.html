
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Memory imaging - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Memory imaging
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../community/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../contributions_mediawiki/" class="md-tabs__link">
        Contributions
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../tags/" class="md-tabs__link">
        Tags
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Contributions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributions" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contributions_mediawiki/" class="md-nav__link">
        Contributions Mediawiki
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tags
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tags" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tags
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        Tags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-from-the-physical-memory-object" class="md-nav__link">
    Reading from the Physical Memory Object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmmapiospace" class="md-nav__link">
    MmMapIoSpace
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-imaging-techniques" class="md-nav__link">
    Memory Imaging Techniques
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#also-see" class="md-nav__link">
    Also see
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-links" class="md-nav__link">
    External Links
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  

  <nav class="md-tags" >
    
      
      
        <a href="../tags/#memory-analysis" class="md-tag">Memory Analysis</a>
      
    
      
      
        <a href="../tags/#memory-imaging" class="md-tag">Memory Imaging</a>
      
    
  </nav>




  <h1>Memory imaging</h1>

<p>Memory imaging is the process of making a bit-by-bit copy of memory. In
principle it is similar to <a href="../disk_imaging/">Disk Imaging</a>.</p>
<p>For physical memory it is common to have sections that are not
accessible, e.g. because of memory-mapped I/O</p>
<p>The resulting copy is stored in a <a href=":category:forensics_file_formats.md">Forensics image
format</a>. Some of these
formats have means to differentiate between an image of memory and e.g.
that of a disk.</p>
<h2 id="introduction">Introduction</h2>
<p>The <a href="../physical_memory/">physical memory</a> of computers can be
imaged and analyzed using a variety of tools. Because the procedure for
accessing physical memory varies between <a href="operating_systems.md">operating
systems</a>, these tools are listed by
operating system. Once memory has been imaged, it is subjected to
<a href="../memory_analysis/">memory analysis</a> to ascertain the state of
the system, extract artifacts, and so on.</p>
<p>One of the most vexing problems for memory imaging is verifying that the
image has been created correctly. That is, verifying that it reflects
the actual contents of memory at the time of its creation. Because the
contents of memory are constantly changing on a running system, the
process can be repeated but the results will never--to a high degree of
probability--be the same. Thus, repeating the acquisition and comparing
the results is not a feasible means of validating correct image
creation. <a href="../memory_analysis/">Memory analysis</a> can reveal
whether the image's contents are consistent with the known layout and
structure of a given operating system, as well as answering other
questions, but it cannot answer the question as to whether the image
accurately reflects the system from which it was taken at the time it
was taken.</p>
<h2 id="methods">Methods</h2>
<h3 id="reading-from-the-physical-memory-object">Reading from the Physical Memory Object</h3>
<p>In <a href="../windows/">Windows</a> the Physical Memory Object,
\\Device\PhysicalMemory, can be used the access physical memory. Since
Windows 2003 SP1 user-mode access to this device-object is no longer
permitted
[<a href="http://technet.microsoft.com/en-en/library/cc787565(v=ws.10">http://technet.microsoft.com/en-en/library/cc787565(v=ws.10</a>).aspx].
A kernel-mode process is still allowed to read from this device-object.</p>
<h3 id="mmmapiospace">MmMapIoSpace</h3>
<p>The MmMapIoSpace function (or routine) is kernel-mode function to map a
physical address range to non-paged system space
[<a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff554618(v=vs.85">http://msdn.microsoft.com/en-us/library/windows/hardware/ff554618(v=vs.85</a>).aspx].</p>
<h2 id="memory-imaging-techniques">Memory Imaging Techniques</h2>
<p>Crash Dumps
When configured to create a full memory dump,
<a href="../windows/">Windows</a> operating systems will automatically save
an image of physical memory when a bugcheck (aka blue screen or kernel
panic) occurs. <a href="andreas_schuster.md">Andreas Schuster</a> has a
<a href="http://computer.forensikblog.de/en/2005/10/acquisition_2_crashdump.html">blog
post</a>
describing this technique.</p>
<p>LiveKd Dumps
The <a href="sysinternals.md">Sysinternals</a> tool
<a href="http://www.microsoft.com/technet/sysinternals/SystemInformation/LiveKd.mspx">LiveKd</a>
can be used to create an image of physical memory on a live machine in
crash dump format. Once livekd is started, use the command ".dump -f
[output file]"</p>
<p>Hibernation Files
<a href="../windows/">Windows</a> 98, 2000, XP, 2003, and Vista support a
feature called <a href="hibernation.md">hibernation</a> that saves the
machine's state to the disk when the computer is powered off. When the
machine is turned on again, the state is restored and the user can
return to the exact point where they left off. The machine's state,
including a compressed image of <a href="../physical_memory/">physical
memory</a>, is written to the disk on the
system drive, usually C:, as <a href="../hiberfil.sys/">hiberfil.sys</a>.
This file can be parsed and decompressed to obtain the memory image.
Once <a href="../hiberfil.sys/">hiberfil.sys</a> has been obtained,
<a href="http://sandman.msuiche.net/">Sandman</a> can be used to convert it to a dd
image.</p>
<p><a href="../mac_os_x/">Mac OS X</a> very kindly creates a file called
<strong>/var/vm/sleepimage</strong> on any laptop that is suspended. This file is NOT
erased when the machine starts up. It is unencrypted even if the user
turns on <a href="../file_vault/">File Vault</a> and enables Secure Virtual
Memory.
<a href="http://pc-eye.blogspot.com/2008/08/live-memory-dump-on-mac-laptops.html">1</a>.</p>
<p>Firewire
It is possible for <a href="../firewire/">Firewire</a> or IEEE1394 devices
to directly access the memory of a computer. Using this capability has
been suggested as a method for acquiring memory images for forensic
analysis. Unfortunately, the method is not safe enough to be widely used
yet. There are some published papers and tools, listed below, but they
are not yet forensically sound. These tools do not work with all
Firewire controllers and on other can cause system crashes. The
technology holds promise for future development, in general should be
avoided for now.</p>
<p>At <a href="cansec_west_05.md">CanSec West 05</a>, <a href="michael_becher.md">Michael
Becher</a>, <a href="maximillian_dornseif.md">Maximillian
Dornseif</a>, and <a href="christian_n._klein.md">Christian N.
Klein</a> discussed an
<a href="exploit.md">exploit</a> which uses <a href="DMA" title="wikilink">DMA</a> to read
arbitrary memory locations of a <a href="../firewire/">firewire</a>-enabled
system. The
<a href="http://md.hudora.de/presentations/firewire/2005-firewire-cansecwest.pdf">paper</a>
lists more details. The exploit is run on an <a href="http://ipodlinux.org/Main_Page">iPod running
Linux</a>. This can be used to grab screen
contents.</p>
<p>This technique has been turned into a tool that you can download from:
<a href="http://www.storm.net.nz/projects/16">http://www.storm.net.nz/projects/16</a></p>
<p>The <a href="http://digitalfire.ucd.ie/?page_id=430">Goldfish</a> tool automates
this exploit for investigators needing to analyze the memory of a Mac.</p>
<p>Cold and Warm reboots
Typical RAM-modules retain memory during reboots as long as power is
provided. The modules typically support a self-refresh. Whether the data
is retained depend on BIOS-es that do or do not clear the RAM during
their initialisation of the motherboards. Warm reboots refer to reboot
methods in which power is never removed from the memory module. Tools
like
<a href="http://mcgrewsecurity.com/oldsite/projects/msramdmp.1.html">msramdump</a>
or
<a href="http://www.sei.cmu.edu/digitalintelligence/tools/afterlife/">afterlife</a>
act like minimal OS-es with a memory footprint around a few 100k that
can save memory to disk (Nowadays often only upto 4G afaik). When the
RAM is cleared by the standard BIOS, <a href="https://ohm2013.org/wiki/Village:Garrison#Lecture:_RAM_Memory_acquisition_using_live-BIOS_modification">replacing the
bios</a>
can be an option. Depending on the motherboard this method works fine.
<a href="http://en.wikipedia.org/wiki/Cold_boot_attack">Cold boot</a> refers to the
cooling of RAM te increase the time the RAM module will retain data
without power. Opinions on how practical cold boot is are discussed in
"<a href="http://www1.cs.fau.de/filepool/projects/coldboot/fares_coldboot.pdf">On the Practicability of Cold Boot
Attacks</a>".</p>
<p>Virtual Machine Imaging
There are numerous popular virtual machines that are in wide use such as
xen, qemu or vmware. If the memory image is for a machine running in
this kind of virtual environment, there are usually two methods for
obtaining a memory image. The common method is to pause/suspend/stop the
system and then collect the resulting memory image file, this has the
disadvantage of taking the machine offline during the suspend time.
Alternatively most of these systems support live dumping of a memory
image. <a href="http://www.qemu.org">Qemu</a> supports the pmemsave function,
<a href="http://www.xen.org">Xen</a> has the xm dump-core command.</p>
<h2 id="also-see">Also see</h2>
<ul>
<li><a href="../memory_analysis/">Memory analysis</a></li>
<li><a href=":tools:memory_imaging.md">Memory Imaging Tools</a></li>
</ul>
<h2 id="external-links">External Links</h2>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Memory-mapped_I/O">Wikipedia article on Memory-mapped
  I/O</a></li>
<li><a href="http://web.archive.org/web/20101210223853/http://blogs.23.nu/RedTeam/0000/00/antville-5201">RedTeam: FireWire
  round-up</a></li>
<li><a href="http://www.friendsglobal.com/papers/FireWire%20Memory%20Dump%20of%20Windows%20XP.pdf">FireWire Memory Dump of a Windows XP Computer: A Forensic
  Approach</a>,
  by <a href="antonio_martin.md">Antonio Martin</a>, 2007</li>
<li><a href="http://forensic.belkasoft.com/en/live-ram-forensics">Catching the ghost: how to discover ephemeral evidence with Live RAM
  analysis</a> by Oleg
  Afonin and Yuri Gubanov, May 2013</li>
<li><a href="http://www.dfrws.org/2013/proceedings/DFRWS2013-13.pdf">Anti-forensic resilient memory
  acquisition</a>,
  by <a href="johannes_stuettgen.md">Johannes Stuettgen</a>, <a href="../michael_cohen/">Michael
  Cohen</a>, August 2013</li>
<li><a href="http://takahiroharuyama.github.io/blog/2014/01/07/64bit-big-size-ram-acquisition-problem/">64bit Big Sized RAM Image Acquisition
  Problem</a>,
  by <a href="takahiro_haruyama.md">Takahiro haruyama</a>, January 7, 2014</li>
<li><a href="http://brimorlabs.blogspot.com/2014/01/all-memory-dumping-tools-are-not-same.html">All memory dumping tools are not the
  same</a>,
  by <a href="brian_moran.md">Brian Moran</a>, January 14, 2014</li>
<li><a href="http://www.rekall-forensic.com/docs/References/Papers/DFRWS2014EU.html">Robust Linux memory acquisition with minimal target
  impact</a>,
  <a href="johannes_stüttgen.md">Johannes Stüttgen</a> <a href="../michael_cohen/">Michael
  Cohen</a>, May 2014</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>